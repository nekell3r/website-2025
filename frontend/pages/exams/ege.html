<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" >
    <title>ЕГЭ</title>
    <link rel="stylesheet" href="../../assets/css/style_ege.css">
    <script src="../../assets/js/payment.js"></script>
    <style>
        body {
            display: flex;
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            font-family: Comic Sans MS, Comic Sans, cursive;
            margin:0px;
            padding: 0px;
            background-color: #3A3A3A
        }
        img.zloy {
            display: inline-block;
            width: 140px !important;
            height: auto;
            border-radius: 3%;
        }
    </style>
</head>
<body>
    <header class="header2">
        <div class="logo">
            <a href="../../index.html"><img src="../../assets/img/злой рус.png" class="zloy" alt="Злой Русский"></a>
        </div>
        <div class="menu">
            <a href="oge.html">ОГЭ</a>
            <a href="ege.html">ЕГЭ</a>
            <a href="../materials/list.html"><b>МАТЕРИАЛЫ ДЛЯ УРОКОВ</b></a>
        </div>
        <div class="buttons">
            <button class="menu-button" onclick="toggleMenu()">
                <img src="../../assets/img/new_hambur.png" alt="кнопка меню">
            </button>
        </div>
    </header>

    <b><h2>Продукт ЕГЭ содержит следующие материалы</h2></b><br>
    
    <div class="two-column-block">
        <div class="column left-column">
            <b><h3> 1. Рабочая тетрадь для подготовки к тестовой части ЕГЭ</h3></b>
            <b><h3>Какой то текст</h3></b>
            <img src = "../../assets/img/work_note3.png" alt="work note3">
            <b><h3>Примеры заданий из рабочей тетради:</h3></b>
            <img src = "../../assets/img/wn.png" alt="wn">
            <b><h3>Орфография</h3></b>
            <img src = "../../assets/img/simbol.png" alt="simbol">
        </div>
        <div class="column right-column">
            <b><h3> 2. Рабочая тетрадь для подготовки к сочинению ЕГЭ</h3></b>
            <b><h3>Какой то текст</h3></b>
            <img src = "../../assets/img/work_note2.png" alt="Правое изображение">
            <b><h3>Примеры заданий из рабочей тетради:</h3></b>
            <b><h3>Комментарий. Обработка</h3></b>
            <img src = "../../assets/img/comm.jpg" alt="Правое изображение">
            <b><h3>Проблема и авторская позиция. Отработка</h3></b>
            <img src = "../../assets/img/пример2.png" alt="Правое изображение">
        </div>
    </div>
    <h3 class="text_ege_under">По резульатам подготовки к сочинению ЕГЭ в 2024 году 100% учеников успешно сдали его с первой попытки. 
        При этом 40% учеников получили от 19 до 21 баллов.</h3>
    <div class="ege_work3_container">
        <b><h3> 3.Рабочая тетрадь для подготовки к Итоговому Сочинению(ИС)</h3></b>
        <h3>Какой-то текст с информацией про материал</h3>
        <img src = "../../assets/img/work_note.jpg" class="work_note" alt="Work note">
    </div>

    <div style="position: relative;
                text-align: center;">
        <b><h3>Примеры заданий из рабочей тетради:</h3></b><br>
        <img src = "../../assets/img/1пример.png" class="one_instance" alt="Свеча горела">
        <b><h3>Построение логики аргументации. Практика</h3></b>
        <h4>В каких жизненных ситуациях нужно быть готовым к смелым поступкам?</h4>
        <img src = "../../assets/img/logic_arg.png" class="one_instance" alt="logic_arg">
    </div>
    <div class="text_and_line-container">
        <h3 class="">По результатам подготовки к итоговому сочинению в 2024 году 100% учеников успешно сдали его с первой попытки.
            При этом 50% учеников получили максимальный балл. </h3>
    </div>

    <div class="pay_cash" style="margin-left: 100px;">
        <b><h1 style="display: flex;">Стоимость продукта - X рублей.</h1></b>
        <b><h1 style="display: flex;">При оплате вы получаете ссылки на скачивание каждого
            из соответствующих материалов в формате PDF:</h1></b>
        
        <b><h1 style="display: flex;">Так же в качестве бонуса вам будет предоставлены ссылки на 
            есурсы для практики по всем заданиям тестовой части - onlinetestpad и edapp</h1></b>
    </div>
    <div>
        <input type="text" id="userInput-ege" placeholder="email для отправки чека" onclick="clearPlaceholder(this)">
    </div>
    <div class="error-message" id="emailError-ege">Пожалуйста, введите email!</div>
    <button style="min-width: 200px;" class="payment-button" data-product-slug="ege" data-input-id="userInput-ege" data-error-id="emailError-ege">Страница оплаты</button>
    
    <div class="text_and_line-container">
        <b><h1 style="display: flex;">Возможны способы оплаты - СБП, Карта МИР, Т-pay</h1></b>
    </div>

    <footer class="the_end">
        <h1>Служебная информация</h1>
        <img src="../../assets/img/злой рус.png" class="zloy" alt="злой рус">
    </footer>

    <div class="dropdown" id="dropdown">
        <span class="close" onclick="toggleMenu()">&times;</span>
        <a href="../auth/login.html">авторизация/личный кабинет</a>
        <a href="#" onclick="checkUserAndRedirect(event)">отзывы</a>
        <a href="../materials/questions.html">FAQ</a>
    </div>

    <script>
        const inputField = document.getElementById('userInput');
        const originalPlaceholder = inputField.placeholder;

        // Обработчик клика по полю ввода
        inputField.addEventListener('focus', function() {
            this.placeholder = '';
        });

        // Обработчик клика вне поля ввода
        document.addEventListener('click', function(event) {
            if (event.target !== inputField) {
                if (inputField.value === '') {
                    inputField.placeholder = originalPlaceholder;
                }
            }
        });
    </script>

    <script>
        function toggleMenu() {
            var menu = document.getElementById("dropdown");
            menu.classList.toggle("active");
        }

        // Добавляем обработчик для кнопки авторизации
        document.getElementById('auth-link').addEventListener('click', async function(e) {
        e.preventDefault();

        try {
            const response = await fetch('https://slick-rice-heal.loca.lt/me/info', {
                method: 'GET',
                credentials: 'include',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json',
                    'ngrok-skip-browser-warning': 'true' // Обход предупреждения ngrok
                }
            });

            if (response.status === 401) {
                // Пользователь не авторизован
                window.location.href = 'auto.html';
                return;
            }


            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const userData = await response.json();
            handleUserData(userData);
            if (userData && userData.id && userData.name) {
                // Сохраняем данные пользователя перед переходом
                sessionStorage.setItem('userData', JSON.stringify(userData));

                // Перенаправляем в личный кабинет
                window.location.href = 'lk.html';
            } else {
                throw new Error('Получены некорректные данные пользователя');
            }

        } catch (error) {
            console.error('Ошибка:', error);
            // Попробуем альтернативный подход без credentials
            tryAlternativeApproach();
        }
    });

    async function tryAlternativeApproach() {
        try {
            const response = await fetch('https://slick-rice-heal.loca.lt/me/info', {
                method: 'GET',
                headers: {
                    'Accept': 'application/json',
                    'ngrok-skip-browser-warning': 'true'
                }
            });

            const data = await response.json();
            console.log('Успешно (без куки):', data);
            handleUserData(data);
        } catch (error) {
            console.error('Ошибка альтернативного запроса:', error);
            alert('Не удалось получить данные. Пожалуйста, войдите в систему.');
            window.location.href = 'auto.html';
        }
    }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="../../assets/js/script.js"></script>
    <script src="../../assets/js/reviews-redirect.js"></script>

</body>
</html>
